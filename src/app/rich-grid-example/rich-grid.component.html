<mat-toolbar color="primary" role="header" style="background: #336386">
<mat-toolbar-row> <mat-icon class="app-icon">assignment_turned_in</mat-icon>
<span style="padding-left: 10px">Forecast Costing & Reports</span> <span
	class="headder-spacer"></span> <span> <img
	*ngIf="hideprogress == false"
	src="https://loading.io/spinners/double-ring/lg.double-ring-spinner.gif"
	style="width: 80px;">
</span> </mat-toolbar-row> </mat-toolbar>
<div style="padding: 5px 5px 10px 10px">
		
	<div style="padding-top: 5px;"> 
		<mat-chip-list #chipList>
			<mat-chip style="  margin-right: 5px" *ngFor="let project of chosenProject" [selectable]="selectable"
						[removable]="removable" (remove)="remove(project)">
				{{project.projectName}}
				<mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
			</mat-chip>
			
			<input matInput placeholder="Project"
					[matChipInputFor]="chipList"
					[matChipInputSeparatorKeyCodes]="separatorKeysCodes"
					[matChipInputAddOnBlur]="addOnBlur"
					(matChipInputTokenEnd)="add($event)"
					[matAutocomplete]="auto2" [formControl]="projectCtrl" style="margin: 0px"/>
			<button mat-stroked-button (click)="getReports()" style="margin: 5px">
				Get Projects
			</button>
		</mat-chip-list>	
		<mat-autocomplete #auto2="matAutocomplete"> 
			<mat-option *ngFor="let project of filteredProjectsObs | async"
				[value]="project.projectId" (click)="autoComplete(project)" > 
				<span>{{project.projectName }}</span> 
			</mat-option> 
		</mat-autocomplete>
	</div>

	<div style="padding-top: 5px;">			
		<input matInput class="head-control" (keyup)="onQuickFilterChanged($event)" type="text"
			id="quickFilterInput" placeholder="Filter Results" />
		<span class="controls-spacing"></span> 
		<button mat-stroked-button (click)="onBtExport()">Export As Excel</button>
		<span class="controls-spacing"></span>
		<button mat-stroked-button (click)="createRowData()">Refresh Data</button>
	</div>

	<div style="padding-top: 5px;">
		<button mat-stroked-button (click)="saveUpdated()">Save</button>
		<span class="controls-spacing"></span>
		<button mat-stroked-button   (click)="openDialog()">Add Row</button>
		<span class="controls-spacing"></span>
		<button mat-stroked-button (click)="onDeleteRow()" [disabled]="!selectedRow">Delete Row</button>
		<span class="controls-spacing"></span>
		<button mat-stroked-button (click)="onDuplicateRow()" [disabled]="!selectedRow">Duplicate Row</button>
	</div>
</div>

<div style="margin: 0px 10px 0px 10px">
	<ag-grid-angular style="width: 100%; height: 500px;" class="ag-fresh"
		[rowClassRules]="rowClassRules" [gridOptions]="gridOptions"
		[columnDefs]="columnDefs" [showToolPanel]="showToolPanel"
		[rowData]="rowData" [excelStyles]="excelStyles" enableColResize
		[enableSorting]="true" enableFilter groupHeaders
		suppressRowClickSelection toolPanelSuppressGroups
		toolPanelSuppressValues rowHeight="22" rowSelection="single"
		[sortingOrder]="sortingOrder" (modelUpdated)="onModelUpdated()"
		(cellClicked)="onCellClicked($event)"
		(cellDoubleClicked)="onCellDoubleClicked($event)"
		(cellContextMenu)="onCellContextMenu($event)"
		(cellValueChanged)="onCellValueChanged($event)"
		(cellFocused)="onCellFocused($event)"
		(rowSelected)="onRowSelected($event)"
		(selectionChanged)="onSelectionChanged($event)"
		(beforeFilterChanged)="onBeforeFilterChanged()"
		(afterFilterChanged)="onAfterFilterChanged()"
		(filterModified)="onFilterModified()"
		(beforeSortChanged)="onBeforeSortChanged()"
		(afterSortChanged)="onAfterSortChanged()"
		(virtualRowRemoved)="onVirtualRowRemoved($event)"
		(rowClicked)="onRowClicked($event)" (gridReady)="onReady($event)"
		(getSelectedRows)="getSelectedRows()"
		(columnEverythingChanged)="onColumnEvent($event)"
		(columnRowGroupChanged)="onColumnEvent($event)"
		(columnValueChanged)="onColumnEvent($event)"
		(columnMoved)="onColumnEvent($event)"
		(columnVisible)="onColumnEvent($event)"
		(columnGroupOpened)="onColumnEvent($event)"
		(columnResized)="onColumnEvent($event)"
		(columnPinnedCountChanged)="onColumnEvent($event)">
	</ag-grid-angular>
</div>