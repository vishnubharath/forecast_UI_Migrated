<div id='top'>
    <h1>Forecast Costing & Reports  <img *ngIf="hideprogress == false" src="https://loading.io/spinners/color-bar/index.colorful-progress-loader.gif" alt="colorful progress bar"></h1>    
    <div style="padding: 4px;">
        <div style="float: right;">
           
        </div>
        <!-- <div>
            <b>Employees Skills and Contact Details</b>
            {{rowCount}}
        </div> -->         
    </div>
    <div style="clear: both;"></div>

    

        <!-- Because we are using the Angular ID (ie #ag-grid marker), we have to have all the items that use
             that marker inside the same ng-if as the grid -->

        <!-- <div style="padding: 4px;" class="toolbar">
            <span>
                Grid API:
                <button (click)="gridOptions.api.selectAll()">Select All</button>
                <button (click)="gridOptions.api.deselectAll()">Clear Selection</button>
            </span>
            <span style="margin-left: 20px;">
                Column API:
                <button (click)="gridOptions.columnApi.setColumnVisible('country', false)">Hide Country Column</button>
                <button (click)="gridOptions.columnApi.setColumnVisible('country', true)">Show Country Column</button>
            </span>
        </div> -->
        <div style="clear: both;"></div>
        <div style="padding: 4px;" class="toolbar">
            <label >
                <input type="button"  value="Export As Excel" (click)="onBtExport()"/>
                
            </label>
            <button (click)="createRowData()">Refresh Data</button>
            <input (keyup)="onQuickFilterChanged($event)" type="text" id="quickFilterInput" placeholder="Type text to filter..."/>
            <button (click)="saveUpdated()">Save</button>
            <button (click)="onDuplicateRow()"  [disabled]="!selectedRow" >Duplicate Row</button>
            <button (click)="openDialog()">Add Data</button>
            
        </div>
        <div style="padding: 4px;"  class="toolbar">
            <div>
                <span>Project : </span>
                <button (click)="getReports()">Check</button>
            </div>
            <div>
                <select multiple [(ngModel)]="chosenProject">            
                    <option value="{{project.projectId}}" *ngFor="let project of projects;">{{project.projectName}}</option>
                </select>
            </div>            
        </div>
        <div>
        <ag-grid-angular style="width: 100%; height: 500px;" class="ag-fresh"

        [gridOptions]="gridOptions"
        [columnDefs]="columnDefs"
        [showToolPanel]="showToolPanel"
        [rowData]="rowData"
        [excelStyles]="excelStyles"
        enableColResize
        [enableSorting]="true"
        enableFilter
        groupHeaders
        suppressRowClickSelection
        toolPanelSuppressGroups
        toolPanelSuppressValues
        rowHeight="22"
        rowSelection="single"
        [sortingOrder]="sortingOrder"
        (modelUpdated)="onModelUpdated()"
        (cellClicked)="onCellClicked($event)"
        (cellDoubleClicked)="onCellDoubleClicked($event)"
        (cellContextMenu)="onCellContextMenu($event)"
        (cellValueChanged)="onCellValueChanged($event)"
        (cellFocused)="onCellFocused($event)"
        (rowSelected)="onRowSelected($event)"
        (selectionChanged)="onSelectionChanged($event)"
        (beforeFilterChanged)="onBeforeFilterChanged()"
        (afterFilterChanged)="onAfterFilterChanged()"
        (filterModified)="onFilterModified()"
        (beforeSortChanged)="onBeforeSortChanged()"
        (afterSortChanged)="onAfterSortChanged()"
        (virtualRowRemoved)="onVirtualRowRemoved($event)"
        (rowClicked)="onRowClicked($event)"
        (gridReady)="onReady($event)"
        (getSelectedRows) = "getSelectedRows()"
        (columnEverythingChanged)="onColumnEvent($event)"
        (columnRowGroupChanged)="onColumnEvent($event)"
        (columnValueChanged)="onColumnEvent($event)"
        (columnMoved)="onColumnEvent($event)"
        (columnVisible)="onColumnEvent($event)"
        (columnGroupOpened)="onColumnEvent($event)"
        (columnResized)="onColumnEvent($event)"
        (columnPinnedCountChanged)="onColumnEvent($event)">
        </ag-grid-angular>
    </div>

</div>